<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="manifest" href="/D30printerPWA/manifest.json" />
    <title>D30 Printer PWA</title>
    <style>
        body { font-family: sans-serif; }
        textarea { width: 100%; box-sizing: border-box; }
        .controls, .content { max-width: 600px; margin: 1em auto; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <main>
        <div class="controls">
            <h1>D30 Printer PWA</h1>
            <button id="connect">Connect to printer</button>
            <button id="disconnect" class="hidden">Disconnect</button>
        </div>
        <div id="main" class="content hidden">
            <p>Label width: <input type="number" id="labelWidth" value="12"> mm, Label height: <input type="number" id="labelHeight" value="30"> mm</p><hr>
            <h3>Text</h3>
            <textarea id="text" rows="5">Hello world</textarea>
            <p>Font size: <input type="number" id="fontSize" value="20">, Offset X: <input type="number" id="offsetX" value="0">, Offset Y: <input type="number" id="offsetY" value="0"></p>
            <button id="printText">Print Text</button><hr>
            <h3>Image</h3>
            <input type="file" id="imageFile" accept="image/*">
            <p>Image width: <input type="number" id="imageWidth" value="100"> px, Dithering: <input type="checkbox" id="dithering"></p>
            <button id="printImage" disabled>Print Image</button>
            <p><canvas id="preview"></canvas></p>
        </div>
    </main>
    <script src="/D30printerPWA/dist/esc-pos-encoder.js"></script>
    <script src="/D30printerPWA/js/app.js"></script>
    <script>
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("/D30printerPWA/sw.js")
                .then((reg) => console.log("Service worker registered", reg))
                .catch((err) => console.log("Service worker not registered", err));
        }
    </script>
</body>
</html>
